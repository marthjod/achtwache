<!DOCTYPE html>
<html>
    <head>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.bundle.min.js"></script>
        <meta charset="utf-8">
        <script type="text/javascript">
            var randomColor = function() {
                return '#'+Math.floor(Math.random()*16777215).toString(16);
            };

            var xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function() {
                if (xhr.readyState === XMLHttpRequest.DONE && xhr.status === 200) {
                    var nodes = JSON.parse(xhr.responseText);

                    var nodeNames = [];
                    var datasets = [];
                    nodes.map(function(node) {
                        if (node.pods === null) {
                            return;
                        }

                        nodeNames.push(node.name);

                        var dataset = {};
                        dataset.data = [];
                        dataset.backgroundColor = [];
                        node.pods.forEach(function(pod) {
                            dataset.data.push(pod.memory_dec);
                            dataset.backgroundColor.push(randomColor());
                        });

                        datasets.push(dataset);
                    });

                    console.log(datasets);
                    var data = {
                        labels: nodeNames,
                        datasets: datasets
                    };
                    console.log(data);

                        var vals = {
                            type: "bar",
                            data: data,
                            options: {
                                legend: {
                                    display: false
                                },
                                scales: {
                                    xAxes: [{
                                        stacked: true
                                    }],
                                    yAxes:[{
                                        stacked: true
                                    }],
                                }
                            }
                        };
                        console.log(vals);
                        new Chart(document.getElementById("chart").getContext("2d"), vals);
                }
            };
            xhr.open("GET", "/nodes", true);
            xhr.setRequestHeader("Accept", "application/json");
            xhr.send();
        </script>
    <head>
    <body>
        <canvas id="chart"></canvas>
    </body>
</html>